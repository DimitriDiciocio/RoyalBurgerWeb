<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Royal Burguer</title>
    <link rel="icon" href="../assets/svg/logo.svg">
    
    <!-- ALTERAÇÃO: FontAwesome CDN carregado no início para garantir disponibilidade dos ícones -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" 
          integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" 
          crossorigin="anonymous" 
          referrerpolicy="no-referrer" />

    <!-- css -->
    <link rel="stylesheet" href="../assets/styles/header.css">
    <link rel="stylesheet" href="../assets/styles/global.css">
    <link rel="stylesheet" href="../assets/styles/footer.css">
    <link rel="stylesheet" href="../assets/styles/mensagens.css">
    <link rel="stylesheet" href="../assets/styles/modais.css">
    <link rel="stylesheet" href="../assets/styles/pagamento.css">
    <!-- js sistema -->
    <script src="../js/utils.js" type="module" defer></script>
    <script src="../js/ui/header.js" type="module" defer></script>
    <script src="../js/ui/alerts.js" type="module" defer></script>
    <script src="../js/ui/imports.js" type="module" defer></script>
    <script src="../js/ui/modais.js" type="module" defer></script>
    <script src="../js/ui/pagamento.js" type="module" defer></script>
    <!-- js complementares -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>

<body>
    <!-- importara header -->
    <div id="header-container"></div>

    <main>
        <div class="pagamento-header">
            <a href="../../index.html" class="voltar">
                <i class="fa-solid fa-chevron-left"></i>
                <p>Voltar</p>
            </a>
        </div>

        <div class="pagamento-container">
            <section class="esquerda" style="width: 50%;">
                        <div class="endereco">
                <div class="informa">
                    <p class="titulo">Endereço</p>
                    <p class="tempo" id="tempo-entrega"></p>
                </div>

                <div class="quadro-endereco" id="endereco-selecionado">
                    <div style="display: flex; align-items: center; gap: 20px"> 
                        <i class="fa-solid fa-location-dot"></i>

                        <div>
                            <p class="titulo" id="endereco-rua"></p>                                                                     
                            <p class="descricao" id="endereco-bairro"></p>
                        </div>
                    </div>

                    <i class="fa-solid fa-angle-down" id="btn-selecionar-endereco"></i>
                </div>

                <!-- Lista de endereços disponíveis -->
                <div class="lista-enderecos" id="lista-enderecos" style="display: none;">
                    <div class="endereco-item" data-endereco-id="novo">
                        <div class="endereco-info">
                            <i class="fa-solid fa-plus"></i>
                            <div>
                                <p class="titulo">Adicionar novo endereço</p>
                                <p class="descricao">Cadastrar um novo endereço de entrega</p>
                            </div>
                        </div>
                    </div>
                    <!-- Endereços serão carregados dinamicamente -->
                </div>
            </div>

            <div class="pagamento">
                <div class="informa">
                    <p class="titulo">Formas de pagamento</p>
                    <p class="detalhe">O pagamento é feito na entrega</p>
                </div>

                <div class="formas-pagamento">
                    <!-- ALTERAÇÃO: Mantido um só quadro de cartão com modal para escolha de tipo -->
                    <div class="quadro-forma selecionado">
                        <p>Pix</p>
                        <i class="fa-brands fa-pix"></i>
                    </div>

                    <div class="quadro-forma" id="quadro-cartao">
                        <div>
                            <p>Cartão</p>
                            <p class="cartao-tipo-info" id="cartao-tipo-info" style="display: none; font-size: 12px; color: #666; margin-top: 4px;"></p>
                        </div>
                        <i class="fa-solid fa-credit-card"></i>
                    </div>

                    <div class="quadro-forma">
                        <div>
                            <p>Dinheiro</p>
                            <p class="troco-info" id="troco-info" style="display: none; font-size: 12px; color: #666; margin-top: 4px;"></p>
                        </div>
                        <i class="fa-solid fa-money-bill"></i>
                    </div>
                </div>

                <button>Fazer pedido</button>
            </div>
        </section>

        <section class="direita" style="width: 50%;">
            <div class="quadro-pedido">
                <p>Itens adicionados</p>

                <div class="itens" id="itens-container">
                    <!-- Itens serão carregados dinamicamente -->
                </div>

                <div class="resumo">
                    <p>Resumo de valores</p>
                    
                    <div class="valor">
                        <p>Subtotal</p>
                        <p id="subtotal-valor">R$ 0,00</p>
                    </div>
                    <div class="valor">
                        <p>Taxa de entrega</p>
                        <p id="taxa-entrega-valor">R$ 0,00</p>
                    </div>
                    <div class="valor">
                        <p>Descontos</p>
                        <p id="descontos-valor">R$ 0,00</p>
                    </div>

                    <div class="pontos-royal">
                        <div class="esquerda">
                            <div>
                                <p>Usar Pontos Royal</p>
                                <p>Você tem <span id="pontos-disponiveis">0</span> pontos Royal</p>
                            </div>

                            <i class="fa-solid fa-circle-info"></i>
                        </div>

                        <div class="direita">
                            <label class="checa">
                                <input type="checkbox">
                                <span class="bolinha"></span>
                            </label>

                            <p id="desconto-pontos-valor">-R$ 0,00</p>
                        </div>
                    </div>

                    <div class="total">
                        <div>
                            <p>Total</p>
                            <p>Nessa compra, você ganhará <span id="pontos-ganhos">0</span> pontos Royal</p>
                        </div>

                        <p id="total-valor">R$ 0,00</p>
                    </div>
                </div>
            </div>
        </section>
        </div>

    </main>
    <!-- importare footer -->
    <div id="footer-container"></div>

    <!-- MODAL TROCO -->
    <div id="modal-troco" class="modal" style="display: none;">
        <div class="div-overlay"></div>
        <div class="modal-content-metricas">
            <div class="header-modal">
                <i class="fa-solid fa-xmark fechar-modal" data-close-modal="modal-troco"></i>
                <h2>Vai precisar de troco?</h2>
            </div>

            <div class="conteudo-modal">
                <p>
                    Digite o valor em dinheiro que será usado para pagar o pedido, 
                    para que assim, caso seja necessário troco, o entregaor levar.
                </p>

                <div class="div-input">
                    <label for="valor">Valor</label>
                    <input type="number" id="valor" name="valor" required autocomplete="off">
                </div>
            </div>

            <div class="footer-modal">
                <button class="btn-fechar" id="btn-confirmar-troco" onclick="confirmarTroco()">Confirmar</button>
            </div>
        </div>
    </div>

    <!-- MODAL TIPO DE CARTÃO -->
    <div id="modal-tipo-cartao" class="modal" style="display: none;">
        <div class="div-overlay"></div>
        <div class="modal-content-metricas">
            <div class="header-modal">
                <i class="fa-solid fa-xmark fechar-modal" data-close-modal="modal-tipo-cartao"></i>
                <h2>Selecione o tipo de cartão</h2>
            </div>

            <div class="conteudo-modal">
                <p>
                    Escolha se o pagamento será feito com cartão de crédito ou débito.
                </p>

                <div class="tipos-cartao-container">
                    <button class="btn-tipo-cartao" id="btn-cartao-credito" type="button">
                        <div class="btn-tipo-cartao-content">
                            <i class="fa-solid fa-credit-card btn-tipo-cartao-icon"></i>
                            <div class="btn-tipo-cartao-text">
                                <p class="btn-tipo-cartao-title">Cartão de Crédito</p>
                                <p class="btn-tipo-cartao-desc">Pagamento via cartão de crédito</p>
                            </div>
                        </div>
                    </button>

                    <button class="btn-tipo-cartao" id="btn-cartao-debito" type="button">
                        <div class="btn-tipo-cartao-content">
                            <i class="fa-solid fa-credit-card btn-tipo-cartao-icon"></i>
                            <div class="btn-tipo-cartao-text">
                                <p class="btn-tipo-cartao-title">Cartão de Débito</p>
                                <p class="btn-tipo-cartao-desc">Pagamento via cartão de débito</p>
                            </div>
                        </div>
                    </button>
                </div>
            </div>

            <div class="footer-modal">
                <button class="btn-fechar" data-close-modal="modal-tipo-cartao">Cancelar</button>
            </div>
        </div>
    </div>

    <!-- MODAL TREVISANDO O PEDIDO -->
    <div id="modal-revisao" class="modal" style="display: none;">
        <div class="div-overlay"></div>
        <div class="modal-content-metricas">
            <div class="header-modal">
                <i class="fa-solid fa-xmark fechar-modal" data-close-modal="modal-revisao"></i>
                <h2>Revise o seu pedido</h2>
            </div>

            <div class="conteudo-modal">
                <div>
                    <i class="fa-solid fa-motorcycle"></i>

                    <div>
                        <p>Entrega hoje</p>
                        <p>Hoje, 40 - 50 min</p>
                    </div>
                </div>

                <div>
                    <i class="fa-solid fa-location-dot"></i>

                    <div>
                        <p>R. Antônio Simões, 4</p>
                        <p>Centro  - Fateb</p>
                    </div>
                </div>

                <div>
                    <!-- ALTERAÇÃO: Separado ícones para cartão de crédito e débito -->
                    <i class="fa-brands fa-pix" style="display: flex;"></i>
                    <i class="fa-solid fa-credit-card" id="modal-cartao-credito-icon" style="display: none;"></i>
                    <i class="fa-solid fa-credit-card" id="modal-cartao-debito-icon" style="display: none;"></i>
                    <i class="fa-solid fa-money-bill" style="display: none;"></i>

                    <div>
                        <p>Pagamento na entraga</p>
                        <p id="modal-pagamento-pix">PIX</p>
                        <p id="modal-pagamento-credito" style="display: none;">Cartão de Crédito</p>
                        <p id="modal-pagamento-debito" style="display: none;">Cartão de Débito</p>
                        <p id="modal-pagamento-dinheiro" style="display: none;">Dinheiro - Troco para R$100,00</p>
                    </div>
                </div>
            </div>

            <div class="footer-modal">
                <button class="btn-fechar" id="btn-confirmar-pedido" onclick="confirmarPedido()">Confirmar pedido</button>

                <p id="btn-alterar-pedido" onclick="fecharModalRevisao()" style="cursor: pointer; color: #666; text-decoration: underline;">Alterar pedido</p>
            </div>
        </div>
    </div>

    <!-- Modal pai - Listagem de endereços -->
    <div id="modal-enderecos" class="modal" style="display: none;" data-reset-on-close="true">
        <div class="div-overlay"></div>
        <div class="modal-contet">
            <div class="header">
                <i class="fa-solid fa-xmark" data-close-modal="modal-enderecos"></i>
                <p class="titulo">Selecionar endereço</p>
                <p class="descricao">Escolha um endereço de entrega ou adicione um novo</p>
            </div>
            
            <div class="main">
                <div id="lista-enderecos-modal" class="lista-enderecos-modal">
                    <!-- Lista de endereços será carregada dinamicamente (incluindo opção de retirar no local) -->
                </div>
            </div>
            
            <div class="footer">
                <button data-close-modal="modal-enderecos">Cancelar</button>
                <button id="btn-adicionar-endereco-modal">Adicionar Endereço</button>
            </div>
        </div>
    </div>

    <!-- Modal filha - Adicionar/Editar endereço -->
    <div id="modal-endereco-form" class="modal" style="display: none;" data-reset-on-close="true">
        <div class="div-overlay"></div>
        <div class="modal-contet">
            <div class="header">
                <i class="fa-solid fa-xmark" data-close-modal="modal-endereco-form"></i>
                <p class="titulo" id="titulo-endereco-form">Adicionar endereço</p>
                <p class="descricao">Campos com (*) são obrigatórios</p>
            </div>

            <div class="main">
                <div class="div-input">
                    <label for="cep-form">CEP*</label>
                    <input type="text" id="cep-form" name="cep" required autocomplete="off">
                    <i class="fa-solid fa-magnifying-glass"></i>
                </div>
                <div class="sep-select">
                    <div class="div-input">
                        <label for="estado-form">Estado*</label>
                        <select id="estado-form" name="estado" required>
                            <option value="" disabled selected>Selecione o estado</option>
                        </select>
                    </div>
                    <div class="div-input">
                        <label for="cidade-form">Cidade*</label>
                        <select id="cidade-form" name="cidade" required>
                            <option value="" disabled selected>Selecione a cidade</option>
                        </select>
                    </div>
                </div>
                <div class="div-input">
                    <label for="rua-form">Rua*</label>
                    <input type="text" id="rua-form" name="rua" required autocomplete="off">
                </div>

                <div class="div-input">
                    <label for="bairro-form">Bairro*</label>
                    <input type="text" id="bairro-form" name="bairro" required autocomplete="off">
                </div>

                <div class="div-input">
                    <label for="numero-form">Número*</label>
                    <input type="number" id="numero-form" name="numero" required autocomplete="off">
                </div>

                <div class="div-checa">
                    <input type="checkbox" id="sem-numero-form">
                    <label for="sem-numero-form">Endereço sem número</label>
                </div>

                <div class="div-input">
                    <label for="complemento-form">Complemento</label>
                    <input type="text" id="complemento-form" name="complemento" autocomplete="off">
                </div>

                <div class="div-checa">
                    <input type="checkbox" id="sem-complemento-form">
                    <label for="sem-complemento-form">Endereço sem complemento</label>
                </div>

            </div>

            <div class="footer">
                <button data-close-modal="modal-endereco-form">Cancelar</button>
                <button id="btn-salvar-endereco-form">Salvar Endereço</button>
            </div>
        </div>
    </div>
</body>

</html>